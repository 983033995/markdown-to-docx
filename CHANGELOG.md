# 更新日志

## v2.1.1 - 2024-11-22

### 🔧 CLI 格式选择优化

#### 修复问题

- ✅ **补全输出格式**: CLI 交互式现在支持完整的 7 种格式
  - 新增: Markdown, TXT (纯文本)
  - 与 GUI 保持一致
  
- ✅ **智能格式过滤**: 自动过滤输入格式,避免自己转自己
  - 检测输入文件格式
  - 动态生成可用输出格式列表
  - 智能选择默认输出格式 (Markdown→DOCX, DOCX→Markdown 等)

- ✅ **多文件批量转换**: 自动检测多文件输入
  - 检测到多个文件时自动切换到批量模式
  - 保留交互式配置选项
  - 无缝切换,用户体验一致

#### 改进

- 📝 显示检测到的输入格式
- 🎯 智能默认格式选择
- 🔄 与 Hammerspoon GUI 逻辑完全一致
- 📦 支持 `mdconv file1.md file2.md file3.md` 批量转换

---

## v2.1.0 - 2024-11-22

### 🎉 重大更新

#### 多格式支持
- ✅ 支持 5 种输出格式：DOCX, PDF, HTML, PPTX, EPUB
- ✅ 格式选择下拉菜单，一键切换
- ✅ 每种格式自动生成对应扩展名的文件

#### 预设配置
- ✅ 8 种预设配置：
  - 自定义
  - 标准文档 (DOCX)
  - 学术论文 (PDF, 带目录和章节编号)
  - 技术报告 (PDF, 带目录)
  - 电子书 (EPUB, 带目录和章节编号)
  - 演示文稿 (PPTX)
  - 网页文章 (HTML, 带目录)
  - 简历 (DOCX)
- ✅ 选择预设自动应用相关配置

#### 文档选项
- ✅ 生成目录 (--toc)
- ✅ 章节编号 (--number-sections)
- ✅ 目录深度配置 (默认 3 级)

#### 格式特定配置
- ✅ **PDF**: 4 种预设 (标准文档、学术论文、技术文档、书籍)
  - 自动配置边距、字体大小、纸张尺寸
- ✅ **HTML**: 3 种主题 (GitHub 风格、简约风格、优雅风格)
- ✅ **DOCX**: 5 种模板 (默认、学术、商务、技术、现代)
- ✅ **PPTX**: 3 种风格 (商务、技术、简约)

#### 配置持久化
- ✅ 自动保存用户配置到 `~/.mdconv_gui.yaml`
- ✅ 下次打开自动恢复上次配置
- ✅ 记住格式、预设、选项等所有设置

#### 界面优化
- ✅ 全新的现代化界面设计
- ✅ 渐变色视觉效果
- ✅ 可折叠的高级选项区域
- ✅ 响应式交互反馈
- ✅ 更大的窗口尺寸 (700x650)

#### 命令构建
- ✅ 使用 `convert_multi.sh` 替代 `batch_convert.sh`
- ✅ 完整的参数传递支持
- ✅ 智能的格式特定参数配置

### 🔧 技术改进

- 重构代码结构，使用 `state` 对象统一管理状态
- 添加 `handleNavigation()` 处理界面交互
- 添加 `buildConvertCommand()` 构建转换命令
- 添加 `loadConfig()` 和 `saveConfig()` 配置管理
- 添加 `applyPreset()` 预设应用逻辑

### 📝 使用说明

1. **快速转换**：
   - 拖拽文件 → 选择格式 → 点击转换
   
2. **使用预设**：
   - 选择预设配置（如"学术论文"）
   - 自动应用最佳配置
   
3. **自定义配置**：
   - 选择"自定义"预设
   - 展开"高级选项"
   - 根据需要调整参数

### 🎯 功能对比

| 功能 | CLI 脚手架 | Hammerspoon GUI |
|------|-----------|----------------|
| 多格式支持 | ✅ | ✅ |
| 预设配置 | ✅ | ✅ |
| 文档选项 | ✅ | ✅ |
| 格式特定配置 | ✅ | ✅ |
| 批量转换 | ✅ | ✅ |
| 配置持久化 | ✅ | ✅ |
| 图形界面 | ❌ | ✅ |
| 快捷键支持 | ❌ | ✅ |

### 🚀 快捷键

- `Cmd+Shift+M`: 打开/关闭转换器窗口

### 📦 兼容性

- 完全兼容现有的 CLI 工具
- 使用相同的转换脚本和配置
- 配置文件独立，不影响 CLI 使用

---

## 升级方法

1. 备份已完成：`init.lua.backup`
2. 重新加载 Hammerspoon 配置
3. 使用 `Cmd+Shift+M` 打开新界面

如遇问题，可恢复备份：
```bash
cd ~/markdown-to-docx/hammerspoon  # 或您的项目路径
cp init.lua.backup init.lua
```
